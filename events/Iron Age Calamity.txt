namespace = iron_age_calamity

#Comet Sighted (lol)
country_event = {
	id = iron_age_calamity.1
	title = iron_age_calamity.1.t
	desc = iron_age_calamity.1.d
	picture = COMET_SIGHTED_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1366 #Iron Age Calamity begins next year with Orbury Erupti9on
		not = { is_year = 1376 }
	}
	mean_time_to_happen = {
		months = 1
	}

    immediate = {
		set_global_flag = iron_age_calamity
		hidden_effect = {
			every_country = { #Everyone gets a bit of fun!
				limit = {
					NOT = { tag = PREV }
				}
				country_event = {
					id = iron_age_calamity.2
					days = 5
				}
			}
			every_country = {
				country_event = { #Supervolcano Eruption
					id = iron_age_calamity.3
					days = 365
				}
			}
		}
	}

	option = { #The End is Nigh!
		name = iron_age_calamity.1.opt.a
		add_stability = -1
	}

    option = { #The Economy, Fools!
		name = iron_age_calamity.1.opt.b
        add_years_of_income = -1
	}

	option = { #We can weather any storm
		name = iron_age_calamity.1.opt.c
		add_war_exhaustion = 8
	}
}

#Comet Sighted (except for everyone else)
country_event = {
	id = iron_age_calamity.2
	title = iron_age_calamity.1.t
	desc = iron_age_calamity.1.d
	picture = COMET_SIGHTED_eventPicture

	is_triggered_only = yes

	option = {
		name = iron_age_calamity.1.opt.a
		add_stability = -1
	}

    option = {
		name = iron_age_calamity.1.opt.b
        add_years_of_income = -1
	}

	option = {
		name = iron_age_calamity.1.opt.c
		add_war_exhaustion = 10
	}
}

#THE END TIMES
country_event = {
	id = iron_age_calamity.3
	title = iron_age_calamity.3.t
	desc = iron_age_calamity.3.d
	picture = COMET_SIGHTED_eventPicture

	is_triggered_only = yes

    immediate = {
		set_global_flag = iron_age_calamity_eruption
	}

	option = {
		name = iron_age_calamity.3.opt.a #Aveia Trembles
		trigger = {
			capital_scope = { NOT = { superregion = aveia_superregion } }
		}
		add_stability = -1
		add_legitimacy = -20
		add_war_exhaustion = 3
	}
	option = {
		name = iron_age_calamity.3.opt.b #The Heavens are Falling
		trigger = {
			capital_scope = { superregion = aveia_superregion }
		}
		add_stability = -2
		add_legitimacy = -30
		add_war_exhaustion = 5

		if = {
			limit = {
				total_development = 20
				NOT = { total_development = 50 }
			}
			random_owned_province = {
				limit = {
					base_tax = 2
				}
				add_base_tax = -1
			}
			random_owned_province = {
				limit = {
					base_production = 2
				}
				add_base_production = -1
			}
			random_owned_province = {
				limit = {
					base_manpower = 2
				}
				add_base_manpower = -1
			}
		}
		if = {
			limit = {
				total_development = 50
				NOT = { total_development = 200 }
			}
			random_owned_province = {
				limit = {
					base_tax = 3
				}
				add_base_tax = -2
			}
			random_owned_province = {
				limit = {
					base_production = 3
				}
				add_base_production = -2
			}
			random_owned_province = {
				limit = {
					base_manpower = 3
				}
				add_base_manpower = -2
			}
		}
		if = {
			limit = {
				total_development = 200
			}
			random_owned_province = {
				limit = {
					base_tax = 4
				}
				add_base_tax = -3
				add_base_production = -1
				add_base_manpower = -1
			}
			random_owned_province = {
				limit = {
					base_production = 4
				}
				add_base_tax = -1
				add_base_production = -3
				add_base_manpower = -1
			}
			random_owned_province = {
				limit = {
					base_manpower = 4
				}
				add_base_tax = -1
				add_base_production = -1
				add_base_manpower = -3
			}
		}
	}
}